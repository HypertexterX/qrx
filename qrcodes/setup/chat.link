#chat?e&w&x=return `BEGIN INSTRUCTIONS:
  WE ARE HERE: <URL>${decodeURI(location.href)}</URL>

  WHERE IS HERE?
  We are in a hypertext operating system that reimagines the IndexedDB as the filesystem and the URL as the terminal interface. Like in Plan9's "everything is a file", here, "everything is a hyperlink" and you generate the code
  
  WHAT IS THE SOURCE?
  This is the sourcecode: <SOURCE>${S.innerText}</SOURCE>

  HOW IT WORKS:
  - your output will either be injected into the source code above or eval()'ed
    - your code is automatically wrapped in anonymous function
    - this is why you must output raw unescaped code DO NOT use '''javascript or '''html etc
  
  TASK:
  Generate a simple chat app:
    - use the global "os" instance
    - reuse this apps existing api/model, stored in "localStorage.k" and "localStorage.m"
    - use streaming mode for ai response
    - add a textarea so that we can change the model or host
    - like with this app, if the hostname is "google" then use the google api otherwise use the openai standard endpoint (like in the source)
    - add a save button that opens a new tab to #chats/YYMMDD-HHMMSS?e=encodeURIComponent(chatHistory)
      - this uses the operating systems echo hyperlink mechanism in a new browser tab to save
      - do not save anything to the os yourself directly, only use the hyperlink method
      - replace YYMMDD-HHMMSS with timestamp as the default filename
      - once saved reuse the same timestamp (even if time changed), this way we don't create multiple copies of same chat
      - allow option to set name but use timestamp as default (so user can add to it, dont just use placeholder actually set the value)
      - replace spaces in filename with hyphens
      - use "os.write" to save
      - use dark mode
      - CTRL+ENTER to submit textarea (along with submit button)
    - do not return an entire html document, just the HTML tags for this and the script tag
`&p=NO MARKDOWN, BEGIN CODE:
