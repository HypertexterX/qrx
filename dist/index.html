<!DOCTYPE html><style>:root{color-scheme:dark;font-family:monospace;white-space:pre-wrap}</style><app id="A"></app><script id="S">D=document,J=JSON,L=localStorage,H=history,RS="replaceState",W=window,O=location.pathname.slice(1)||"os",F="files",ONS="onsuccess";class OS{constructor(){W.onhashchange=()=>this.run(),this.boot()}async boot(){if(await this.cdb(),!new URLSearchParams(location.hash.split("?")[1]).has("safe")){let e=await this.keys(IDBKeyRange.bound("boot","bootï¿¿"));for(let t of e)try{new Function(O,await this.read(t))(this)}catch(e){console.error(t,e)}}this.run()}cdb(){return new Promise(e=>{let t=indexedDB.open(O);t.onupgradeneeded=e=>e.target.result.createObjectStore(F),t[ONS]=t=>{this.db=t.target.result,e()}})}tx(e="readonly"){return this.db.transaction(F,e).objectStore(F)}write(e,t){return new Promise(a=>this.tx("readwrite").put(t,e)[ONS]=a)}read(e){return new Promise(t=>this.tx().get(e)[ONS]=e=>t(e.target.result))}keys(e){return new Promise(t=>this.tx().getAllKeys(e)[ONS]=e=>t(e.target.result))}async run(){if(this.db||await this.cdb(),!location.hash)return H[RS](0,"","#home"),this.run();let e=location.hash.slice(1),[t,a]=e.split("?"),r=t,s=new URLSearchParams(a),i=await this.read(t)||"",n=!1;a&&this.write("H/"+Date.now(),e);for(let[e,t]of s){let a;if(a=await this.read("cmd/"+e))try{let e=await new Function(O,"v","arg",a)(this,i,t);void 0!==e&&(i=e)}catch(t){console.error(e,t)}else if("a"==e)n="0"!=t;else if("f"==e)r=t;else if("kmsh".includes(e))L.setItem(e,t);else if("erup".includes(e)){let a=t;"r"==e&&(a=await this.read(t)||""),"u"==e&&(a=await(await fetch(t)).text()),"p"==e&&(a=await this.gen(i,t)),i=n?i+a:a}else if("w"==e)await this.write(r,i);else if("x"==e)try{let e=await new Function(O,"v",t)(this,i);void 0!==e&&(i=e)}catch(e){console.error(e)}}a&&await this.write(r,i),a&&H[RS](0,"","#"+t);let o=await this.read(t)||"";s.has("safe")?A.innerHTML=o:this.rehydrate(o)}rehydrate(e){A.innerHTML=e,A.querySelectorAll("script").forEach(e=>{let t=D.createElement("script");Array.from(e.attributes).forEach(e=>t.setAttribute(e.name,e.value)),t.text=e.textContent,e.replaceWith(t)})}async gen(e,t){let a,r,s,[i,n,o,c]=["k","m","s","h"].map(e=>L.getItem(e)),h="google"==c,l=(o||"")+e+t,d=h?`https://generativelanguage.googleapis.com/v1beta/models/${n}:generateContent?key=${i}`:c,w=h?{contents:[{parts:[{text:l}]}]}:{model:n,messages:[{role:"user",content:l}]},u={"Content-Type":"application/json"};!h&&i&&(u.Authorization=`Bearer ${i}`),A.innerHTML="Thinking...";try{a=await fetch(d,{method:"POST",headers:u,body:J.stringify(w)}),r=await a.json(),s=h?r.candidates?.[0]?.content?.parts?.[0]?.text:r.choices?.[0]?.message?.content}catch(e){s=e.message}return s||""}}os=new OS</script>